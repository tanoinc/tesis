
\subsection{Infraestructura del \eng{backend}}
\label{marco_teorico}

En la arquitectura del \eng{sofware} existen muchas capas entre el usuario y el procesador físico que ejecuta las instrucciones. Una de ellas, es la denominada como \eng{backend}. Esta capa es la que se encarga de manejar la lógica de negocios y el almacenamiento, y su ejecución se hará del lado del servidor.

En las siguientes secciones analizaremos las características técnicas requeridas por las necesidades planteadas en la introducción de ese capítulo, que justifiquen las decisiones para este desarrollo (en relación con el \eng{backend}).

\subsubsection{Sistemas distribuidos}
\label{sistemas_distribuidos}

Al comienzo de la era de las computadoras modernas, entre 1945 y 1985, estas eran muy costosas y de gran tamaño. Además operaban independientemente unas de otras.

A mediados de los años 80, ocurrieron dos avances tecnológicos claves que resultaron en el comienzo de una nueva era para favorecer el desarrollo de los sistemas distribuidos\cite{artnoema}. 

El primero es el avance en la potencia de los microprocesadores: se produjo un gran aumento del poder de cómputo y a su vez una considerable reducción en su precio. Esto fue tan vertiginoso que, como indica Tanembaum, \comillas{si los autos hubieran mejorado a este ritmo en el mismo período de tiempo, un \textit{Rolls Royce} hoy hubiera costado 1 dólar y obtendríamos un billón de millas por galón. Desafortunadamente, también sería probable que tuviera un manual de 200 páginas explicando cómo abrir la puerta}\cite{tanenbaum2007distributed}.

El segundo avance se trata de la aparición de las redes de alta velocidad: desde las redes de área local, hasta las redes de área amplia, permitieron que miles de computadoras se conecten entre sí. Con velocidades variantes, han ido evolucionando desde unos pocos Kilobits hasta Gigabits por segundo.

En conclusión, estos dos factores hacen que hoy sea posible desarrollar fácilmente sistemas que integren a múltiples computadoras que interactúan a través de redes de alta velocidad.
Estos sistemas y su interacción definen un sistema distribuido.

Tanembaum y Van Steen definen a los sistemas distribuidos como \comillas{una colección independiente de computadoras que se muestran a sus usuarios como un único sistema coherente}\cite[p.~2]{tanenbaum2007distributed}. De esta manera especifican que sus principales objetivos son:

\begin{itemize}
\item Hacer que los recursos remotos estén disponibles de manera controlada y eficiente.
\item Ocultar que procesos y recursos están físicamente dispersos entre computadoras distintas.
\item Ser abiertos. Esto significa que el acceso a sus servicios esté establecido por ciertas reglas estándar que definan su sintaxis y su semántica.
\item Ser escalables. Esto es que tenga la posibilidad de crecer sin perder calidad en el servicio.
\end{itemize}

Estos objetivos serán requerimientos primordiales para llevar a cabo la integración de los servicios de la Universidad con la aplicación móvil.

\paragraph{Servicios Web}
\label{servicios_web}

Según la definición de la \gls{uddi}, los Servicios Web son \comillas{aplicaciones modulares, auto-contenidas que tienen interfaces abiertas, orientadas a Internet y basadas en estándares}\cite{uddi2001uddi}. 

En términos generales, son la manera de exponer información y funcionalidad de un sistema a través de tecnologías Web, respetando sus estándares. El uso de estos es clave, ya que reduce la heterogeneidad existente entre sistemas facilitando su integración\cite{alonso2004web}.Esto nos permite utilizar los estándares Web como medio para comunicar sistemas. 

Por estas razones se considera a los servicios Web como interfaz para realizar la comunicación de las aplicaciones de la Universidad.
En las siguientes secciones se revisan los distintos tipos de servicios web, describiendo sus principales características.

\paragraph{SOAP}
\label{soap}

\gls{soap} define un protocolo de envío de información estructurada, con un tipo asociado y de manera descentralizada utilizando como lenguaje \gls{XML}\cite{box2000simple}. Estos datos pueden viajar sobre protocolos de transporte existentes como \gls{http} o \gls{smtp}.

Un mensaje en \gls{soap} consta de un elemento \comillas{sobre} (en inglés \eng{Envelope}) que dentro contiene otros dos elementos: un encabezado (\eng{header}) y un cuerpo(\eng{body}). Con esta estructura básica, ya es posible la comunicación.

\begingroup
  \xmlfile{src/codigo/02-capitulo-2/soap.xml}
  \captionof{listing}{Ejemplo de estructura básica de mensaje XML en \gls{soap}. \eng{Envelope} tiene dos hijos: \eng{header} y \eng{body}.\label{codigo_soap}}
\endgroup

Por otra parte, \gls{soap} define un modelo que le permite indicar a los receptores del mensaje cómo deben procesarlo. Modela el concepto de \textit{actor} que es quien sabe qué parte del mensaje le corresponde y cual descartar para enviar al siguiente.

Sus servicios permiten especificar un documento \gls{WSDL} (en formato \gls{XML}) utilizado para detallar la interfaz de conexión, brindando información al usuario sobre los parámetros y sus tipos de dato.

Las fortalezas de \gls{soap}\cite{pautasso2008restful} son:

\begin{itemize}
\item Transparencia e independencia respecto del protocolo de transporte.
\item El uso de \gls{WSDL} para describir la interfaz del servicio ayuda a abstraer detalles del protocolo de comunicación y serialización, así como también cuestiones de la plataforma sobre el que está implementado (y el lenguaje utilizado).
\end{itemize}

Sus debilidades:

\begin{itemize}
\item Permite la existencia de problemas de interoperabilidad cuando se filtran tipos de datos nativos o construcciones del lenguaje en la interfaz, atravesando las capas de abstracción.
\item Produce un \comillas{desajuste de impedancia} que resulta costoso al traducir los datos en formato \gls{XML} a datos utilizados en lenguajes orientados a objetos.
\end{itemize}

\paragraph{REST}
\label{rest}

\gls{rest}\cite{fielding2000rest} es una arquitectura de servicios (cliente-servidor) que se basa en los estándares de la Web. En ella, los datos y las funciones son considerados recursos y estos son accedidos mediante \gls{uri}. Las acciones sobre estos recursos son las definidas por los verbos del protocolo \gls{http}: GET, POST, PUT, DELETE (entre otros). A las \gls{api} que implementan la arquitectura \gls{rest}, se les dicen que son \gls{restful}.

De esta forma, su diseño fomenta que lo servicios sean simples, livianos y performantes.

Sus fortalezas son\cite{pautasso2008restful}:
\begin{itemize}
\item Su sencillez: al utilizar estándares web (\gls{http}, \gls{uri}, \gls{mime}, \gls{json}, \gls{XML}) definidos por la \gls{w3c} e \gls{ietf}, la infraestructura necesaria para su implementación, es de uso generalizado.
\item Servidores y clientes \gls{http} están disponibles para la mayoría de los lenguajes de programación, sistemas operativos y plataformas. Además el puerto 80 generalmente se deja abierto en cualquier configuración de \eng{firewall}.
\item Infraestructura liviana y económica.
\item Fácilmente escalable gracias a que soporta caché, balance de carga y \gls{clustering}.
\item Permite formatos de mensajes livianos como \gls{json} o inclusive texto plano para tipo de datos simples.
\end{itemize}

Sus debilidades son:
\begin{itemize}
\item Su implementación, al ser abierta, a veces no se adapta al correcto uso de los verbos \gls{http}.
\item Para solicitudes idempotentes (utilizando el verbo \eng{GET}), existe una limitación en el tamaño de la \gls{uri} de 4KB.
\end{itemize}

\paragraph{SOAP o REST: Conclusión}
\label{soap_vs_rest}

En base a las ventajas y desventajas de ambas tecnologías, se realizó un análisis\cite[p.~809]{pautasso2008restful} y se concluyó que es conveniente utilizar \gls{rest} para integrar servicios a medida a través de la Web y preferir \gls{soap} en la integración de aplicaciones de negocio y que posean como requisito la calidad de servicio.

En base a lo analizado se concluye que la utilización de servicios \gls{rest} es conveniente para este desarrollo puesto que: provee mayor flexibilidad, es más liviana, sus tecnologías son de uso generalizado y se adapta correctamente a las necesidades de conexión de los dispositivos móviles y de otros servicios externos que consuman la información provista. Además facilita la posibilidad de escalar horizontalmente y permite el uso de caché.

Por otra parte, para la comunicación con aplicaciones móviles, \gls{rest} supera ampliamente a \gls{soap}. Una evaluación hecha\cite{hamad2010performance} demostró que \gls{rest} tuvo una mejor \eng{performance} debido a mensajes de menor tamaño y tiempos de respuesta más cortos, además de su alta flexibilidad y bajo \eng{overhead}. 

En conclusión, se recomienda la utilización de servicios RESTful\cite{hamad2010performance} para la conexión entre el \eng{backend} y el dispositivo.

\paragraph{Diseño de una API RESTful}
\label{caracteristicas_api_restful}

Para la comunicación con otras aplicaciones utilizando \gls{rest} es necesario definir una \gls{api} que cumpla con sus características\cite{fielding2000rest}. Estas son:
\begin{itemize}
\item \textbf{Comunicación sin estado}:
\item \textbf{Orientada a recursos}:
\item \textbf{Las acciones como \comillas{verbos \gls{http}}}:
\item \textbf{Estado de respuesta utilizando códigos  \gls{http}}:
\item \textbf{Versionable}:
\end{itemize}

\subsubsection{Autorización y autenticación}
\label{autorizacion_autenticacion}

Al definirse la utilización de servicios \gls{rest} para la comunicación, el siguiente paso es determinar qué mecanismos de seguridad existen para realizar la autorización y autenticación de los diferentes actores (usuarios de aplicación móvil y otros sistemas externos). 

Se denomina autenticación al proceso de determinar que algo o alguien es quien dice ser.

\paragraph{OAuth}
\label{oauth}

\paragraph{API Key y API Secret}
\label{apikey}
